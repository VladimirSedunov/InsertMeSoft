# InsertMeSoft

<h1 align="center">Утилита для заливки в тестовую Базу данных выборки по СНИЛС из другой БД.</h1>
<hr>

## Проект реализован с использованием
C# = Java = DB2 for z/OS

![](/design/icons/cs.png)&emsp;![](/design/icons/Java.png)&emsp;![ ](/design/icons/db2.png)
<hr>

## Назначение утилиты: 

1. Создание скрипта для получения выборки по СНИЛС / нескольких СНИЛС.
2. Обработка выборки данных по СНИЛС из одной БД, создание скрипта для заливки (набор Insert'ов) этих данных на другую БД.
3. Заливка выборки на стенд.
4. Копирование (а также множественное клонирование) СНИЛС с одного стенда на другой (или на тот же стенд) с возможностью изменения номера СНИЛС.
5. Используется для заливки данных со стендов Заказчика на наши тестовые стенды или между нашими стендами.


#### _Примечание:_ _в настоящее время существует WEB-версия этой утилиты_
<hr>

## Внешний вид:
* Многие визуальные элементы (кнопки, поля, чекбоксы и т.п.) снабжены всплывающими подсказками.
* Для работы используются вкладки "V5" и "Копия".
* Вкладка "V5", предназначенная для обработки выборки с последующим формированием скрипта заливки на стенд либо заливки на стенд напрямую из выборки.
* Также здесь расположена панель визуальных элементов "Запрос выборки для АСТП" для формирования и последующей отправки Заказчику скрипта, посредством которого будет сформирована выборка.
* Слева от текстового поля/окна ("Окно 1", "Окно 2") есть кнопки: с веником - очистить окно, с блокнотиком - скопировать в буфер текст в окне, а также чекбокс для переноса строк, которые не умещаются по ширине окна.
  
![ ](/design/images/vid1.png)

### Панель "V5" является основной в работе со СНИЛСами.

Для обработки выборки необходимо 

* Выбрать БД тестового стенда. При этом будет автоматически показана текущая версия выбранной БД. Если вместо версии БД появится "v. неизвестно", необходимо проверить наличие коннекта с БД (включен ли VPN, есть ли доступ к БД, в порядке ли интернет и т.д.).
* Выбрать режим работы с помощью набора чекбоксов:
  * "не все doc_mass" - не загружать "лишние" записи (для ИП). Некоторые выборки по СНИЛСу ИП или крупного предприятия содержат в таблице SPU_DOC_MASS записи с рег.номером этого ИП, но относящиеся к другим ИП (другим снилсам). \
Иногда их очень много (сотни и даже тысячи, если предприятие большое), и они фактически не нужны. В этом случае лучше такие записи не загружать.
  * "Случайные ФИО" - Для СНИЛСов ФИО выбираются случайным образом из файлов, лежащих в папке FIO_Men_Women.
  * "Загружать буферные таблицы" - Инсерты по всем схемам, включая буферные таблицы. Если выключен - только по SPUMST и USPN.
  * "Автозаливка в БД" - После формирования инсёртов они будут автоматически выполнены. То есть, заливка в БД произойдёт без участия пользователя. Работает только в случае, когда заливается ровно один СНИЛС.
* Нажать на кнопку старта (с рисунком зелёной ступни). \
Появится диалоговая панель для выбора файла с выборкой по СНИЛСу. \
Кодировка файла определяется автоматически, но предпочтительна "utf-8 без BOM". \
По мере работы утилиты будут появляться сообщения в Окне 1. \
Если счёт уже есть в БД, прога запрашивает пользователя о дальнейших действиях. При согласии на перезаливку СНИЛС автоматически удаляется из БД и заливается заново.


![ ](/design/images/panelV5.png)

<hr>

